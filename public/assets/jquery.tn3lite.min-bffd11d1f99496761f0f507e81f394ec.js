/*!
 * tn3 v1.3.0.52
 * http://tn3gallery.com/
 *
 * License
 * http://tn3gallery.com/license
 *
 * Date: 07 Sep, 2012 12:33:07 +0300
 */
(function(e){function t(t){var r=t.skinDir+"/"+t.skin,i=a[r];return i?i.loaded?n.call(this,t,i.html):i.queue.push({c:this,s:t}):(a[r]={loaded:!1,queue:[{c:this,s:t}]},e.ajax({url:r+".html",dataType:"text",success:function(e){var t=a[r];t.loaded=!0,t.html=e;for(e=0;e<t.queue.length;e++)n.call(t.queue[e].c,t.queue[e].s,t.html)},dataFilter:function(e){return e=e.substring(e.indexOf("<body>")+6,e.lastIndexOf("</body>"))},error:function(){if(t.error){var n=e.Event("tn3_error");n.description="tn3 skin load error",t.error(n)}}})),this}function n(t,n){this.each(function(){for(var r=e(this),i,s,o=n.indexOf("<img src=");o!=-1;)o+=10,s=n.indexOf('"',o),i=t.skinDir+"/"+n.substring(o,s),n=n.substr(0,o)+i+n.substr(s),o=n.indexOf("<img src=",o);r.append(n),r.data("tn3").init(r,t.fullOnly)})}function r(t){var n=[],r=t.children(".tn3.album"),o,u;if(r.length>0)r.each(function(t){o=e(this),n[t]={title:o.find(":header").html()},e.extend(n[t],s(o));if(u=i(o))n[t].imgs=u,n[t].thumb||(n[t].thumb=n[t].imgs[0].thumb)});else if(u=i(t))n[0]={imgs:u};return n}function i(t){var n=[],r,i;return r=t.children("ol,ul").children("li"),r.length>0?r.each(function(t){i=e(this),$firsta=i.find("a:not(.tn3 > a)").filter(":first"),n[t]={title:i.find(":header").filter(":first").html()},$firsta.length>0?(n[t].img=$firsta.attr("href"),n[t].thumb=$firsta.find("img").attr("src")):n[t].img=i.find("img").filter(":first").attr("src"),e.extend(n[t],s(i))}):(r=t.find("img"),r.each(function(t){i=e(this),$at=i.parent("a"),n[t]=$at.length==0?{title:i.attr("title"),img:i.attr("src")}:{title:i.attr("title"),img:$at.attr("href"),thumb:i.attr("src")}})),n.length==0?null:n}function s(t){var n={};t=t.children(".tn3");var r;return e.each(t,function(){r=e(this),n[r.attr("class").substr(4)]=r.html()}),n}function o(t){e('a[href^="#tn3-'+t+'"]').click(function(n){var r=f[t];n=e(n.currentTarget).attr("href"),n=n.substr(n.indexOf("-",5)+1),n=n.split("-");switch(n[0]){case"next":r.cAlbum!=null&&r.show("next",n[1]=="fs");break;case"prev":r.cAlbum!=null&&r.show("prev",n[1]=="fs");break;default:r.cAlbum!=parseInt(n[0])?r.showAlbum(parseInt(n[0]),parseInt(n[1]),n[2]=="fs"):r.show(parseInt(n[1]),n[2]=="fs")}})}function u(){if(f.length==0){var t=e(".tn3gallery");t.length>0&&t.tn3({})}}if(/1\.(0|1|2|3|4)\.(0|1)/.test(e.fn.jquery)||/^1.1/.test(e.fn.jquery)||/^1.2/.test(e.fn.jquery)||/^1.3/.test(e.fn.jquery))alert("tn3gallery requires jQuery v1.4.2 or later!  You are using v"+e.fn.jquery);else{var a={},f=[];e.fn.tn3=function(i){e.each(["skin","startWithAlbums","external"],function(e,t){var n=t.split(".");n.length>1&&i[n[0]]?delete i[n[0]][n[1]]:delete i[t]}),i=e.extend(!0,{},e.fn.tn3.config,i);if(i.skin!=null)typeof i.skin=="object"?(i.skinDir+="/"+i.skin[0],i.cssID==null&&(i.cssID=i.skin[0]),i.skin=i.skin[1]):i.skinDir+="/"+i.skin;else{i.skin="tn3",i.skinDir+="/tn3";var s=!0}return i.cssID==null&&(i.cssID=i.skin==null?"tn3":i.skin),this.each(function(){var t=e(this);i.fullOnly?t.hide():t.css("visibility","hidden");var n=i.data?i.data:r(t);n=f.push(new e.fn.tn3.Gallery(n,i))-1,t.data("tn3",f[n]);for(var s=0;s<e.fn.tn3.plugins.length;s++)e.fn.tn3.plugins[s].init(t,i);t.empty(),o(n)}),s?n.call(this,i,i.skinDefault):t.call(this,i),this},e.fn.tn3.plugins=[],e.fn.tn3.plugIn=function(t,n){e.fn.tn3.plugins.push({id:t,init:n})},e.fn.tn3.version="1.3.0.52",e.fn.tn3.config={data:null,skin:null,skinDir:"skins",skinDefault:'<div class="tn3-gallery"><div class="tn3-image"><div class="tn3-text-bg"><div class="tn3-image-title"></div><div class="tn3-image-description"></div></div><div class="tn3-next tn3_v tn3_o"></div><div class="tn3-prev tn3_v tn3_o"></div><div class="tn3-preloader tn3_h tn3_v"><img src="preload.gif"/></div><div class="tn3-timer"></div></div><div class="tn3-controls-bg tn3_rh"><div class="tn3-sep1"></div><div class="tn3-sep2"></div><div class="tn3-sep3"></div></div><div class="tn3-thumbs"></div><div class="tn3-fullscreen"></div><div class="tn3-show-albums"></div><div class="tn3-next-page"></div><div class="tn3-prev-page"></div><div class="tn3-play"></div><div class="tn3-count"></div><div class="tn3-albums"><div class="tn3-inalbums"><div class="tn3-album"></div></div><div class="tn3-albums-next"></div><div class="tn3-albums-prev"></div><div class="tn3-albums-close"></div></div></div>',cssID:null},e.fn.tn3.translations={},e.fn.tn3.translate=function(t,n){if(!n){var r=e.fn.tn3.translations[t];return r?r:t}e.fn.tn3.translations[t]=n},e(function(){setTimeout(u,1)})}})(jQuery),function(e){e.fn.tn3utils=U={},U.shuffle=function(e){var t,n,r=e.length;if(r)for(;--r;)n=Math.floor(Math.random()*(r+1)),t=e[n],e[n]=e[r],e[r]=t},e.extend(e.easing,{def:"easeOutQuad",swing:function(t,n,r,i,s){return e.easing[e.easing.def](t,n,r,i,s)},linear:function(e,t,n,r,i){return r*t/i+n},easeInQuad:function(e,t,n,r,i){return r*(t/=i)*t+n},easeOutQuad:function(e,t,n,r,i){return-r*(t/=i)*(t-2)+n},easeInOutQuad:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t+n:-r/2*(--t*(t-2)-1)+n},easeInCubic:function(e,t,n,r,i){return r*(t/=i)*t*t+n},easeOutCubic:function(e,t,n,r,i){return r*((t=t/i-1)*t*t+1)+n},easeInOutCubic:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t+n:r/2*((t-=2)*t*t+2)+n},easeInQuart:function(e,t,n,r,i){return r*(t/=i)*t*t*t+n},easeOutQuart:function(e,t,n,r,i){return-r*((t=t/i-1)*t*t*t-1)+n},easeInOutQuart:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t+n:-r/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(e,t,n,r,i){return r*(t/=i)*t*t*t*t+n},easeOutQuint:function(e,t,n,r,i){return r*((t=t/i-1)*t*t*t*t+1)+n},easeInOutQuint:function(e,t,n,r,i){return(t/=i/2)<1?r/2*t*t*t*t*t+n:r/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(e,t,n,r,i){return-r*Math.cos(t/i*(Math.PI/2))+r+n},easeOutSine:function(e,t,n,r,i){return r*Math.sin(t/i*(Math.PI/2))+n},easeInOutSine:function(e,t,n,r,i){return-r/2*(Math.cos(Math.PI*t/i)-1)+n},easeInExpo:function(e,t,n,r,i){return t==0?n:r*Math.pow(2,10*(t/i-1))+n},easeOutExpo:function(e,t,n,r,i){return t==i?n+r:r*(-Math.pow(2,-10*t/i)+1)+n},easeInOutExpo:function(e,t,n,r,i){return t==0?n:t==i?n+r:(t/=i/2)<1?r/2*Math.pow(2,10*(t-1))+n:r/2*(-Math.pow(2,-10*--t)+2)+n},easeInCirc:function(e,t,n,r,i){return-r*(Math.sqrt(1-(t/=i)*t)-1)+n},easeOutCirc:function(e,t,n,r,i){return r*Math.sqrt(1-(t=t/i-1)*t)+n},easeInOutCirc:function(e,t,n,r,i){return(t/=i/2)<1?-r/2*(Math.sqrt(1-t*t)-1)+n:r/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(e,t,n,r,i){e=1.70158;var s=0,o=r;return t==0?n:(t/=i)==1?n+r:(s||(s=i*.3),o<Math.abs(r)?(o=r,e=s/4):e=s/(2*Math.PI)*Math.asin(r/o),-(o*Math.pow(2,10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s))+n)},easeOutElastic:function(e,t,n,r,i){e=1.70158;var s=0,o=r;return t==0?n:(t/=i)==1?n+r:(s||(s=i*.3),o<Math.abs(r)?(o=r,e=s/4):e=s/(2*Math.PI)*Math.asin(r/o),o*Math.pow(2,-10*t)*Math.sin((t*i-e)*2*Math.PI/s)+r+n)},easeInOutElastic:function(e,t,n,r,i){e=1.70158;var s=0,o=r;return t==0?n:(t/=i/2)==2?n+r:(s||(s=i*.3*1.5),o<Math.abs(r)?(o=r,e=s/4):e=s/(2*Math.PI)*Math.asin(r/o),t<1?-0.5*o*Math.pow(2,10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s)+n:o*Math.pow(2,-10*(t-=1))*Math.sin((t*i-e)*2*Math.PI/s)*.5+r+n)},easeInBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*(t/=i)*t*((s+1)*t-s)+n},easeOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),r*((t=t/i-1)*t*((s+1)*t+s)+1)+n},easeInOutBack:function(e,t,n,r,i,s){return s==undefined&&(s=1.70158),(t/=i/2)<1?r/2*t*t*(((s*=1.525)+1)*t-s)+n:r/2*((t-=2)*t*(((s*=1.525)+1)*t+s)+2)+n},easeInBounce:function(t,n,r,i,s){return i-e.easing.easeOutBounce(t,s-n,0,i,s)+r},easeOutBounce:function(e,t,n,r,i){return(t/=i)<1/2.75?r*7.5625*t*t+n:t<2/2.75?r*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?r*(7.5625*(t-=2.25/2.75)*t+.9375)+n:r*(7.5625*(t-=2.625/2.75)*t+.984375)+n},easeInOutBounce:function(t,n,r,i,s){return n<s/2?e.easing.easeInBounce(t,n*2,0,i,s)*.5+r:e.easing.easeOutBounce(t,n*2-s,0,i,s)*.5+i*.5+r}})}(jQuery),function(e){e.fn.tn3.Gallery=function(t,n){this.data=t,this.config=e.extend(!0,{},e.fn.tn3.Gallery.config,n),this.initialized=!1,this.t=e.fn.tn3.translate,this.loader=new e.fn.tn3.External(n.external,this)},e.fn.tn3.Gallery.config={cssID:"tn3",active:[],inactive:[],iniAlbum:0,iniImage:0,imageClick:"next",startWithAlbums:!1,autoplay:!1,delay:7e3,timerMode:"bar",timerSteps:300,timerStepChar:"&#8226;",isFullScreen:!1,fullOnly:!1,width:null,height:null,mouseWheel:!0,keyNavigation:"fullscreen",timerOverStop:!0,responsive:!1,image:{},thumbnailer:{}},e.fn.tn3.Gallery.prototype={config:null,$c:null,$tn3:null,data:null,thumbnailer:null,imager:null,cAlbum:null,timer:null,items:null,initialized:null,n:null,albums:null,loader:null,fso:null,timerSize:null,special:null,areHidden:!1,$inImage:null,isPlaying:!1,cparent:null,init:function(t,n){this.$c=t;if(!(this.loader.reqs>0||this.data.length==0||n)){this.trigger("init_start"),this.config.fullOnly&&this.$c.show(),this.$c.css("visibility","visible"),this.$tn3=this.$c.find("."+this.config.cssID+"-gallery");var r=this.config.initValues={width:this.$tn3.width(),height:this.$tn3.height()};this.$tn3.css("float","left"),r.wDif=this.$tn3.outerWidth(!0)-r.width,r.hDif=this.$tn3.outerHeight(!0)-r.height,this.replaceMenu("tn3gallery.com","http://tn3gallery.com");var i=this;this.timer=new e.fn.tn3.Timer(this.$c,this.config.delay,this.config.timerSteps),this.$c.bind("timer_end",function(){i.show("next")}),this.special={rv:[],rh:[],v:[],h:[],vi:[],hi:[],o:[]},this.parseLayout(),this.center(),e.each(this.items,function(t,n){switch(t){case"next":n.click(function(e){i.show("next"),e.stopPropagation()}),n.attr("title",i.t("Next Image"));break;case"prev":n.click(function(e){i.show("prev"),e.stopPropagation()}),n.attr("title",i.t("Previous Image"));break;case"next-page":n.click(function(){i.items.thumbs&&i.thumbnailer.next(!0)}),n.attr("title",i.t("Next Page"));break;case"prev-page":n.click(function(){i.items.thumbs&&i.thumbnailer.prev(!0)}),n.attr("title",i.t("Previous Page"));break;case"thumbs":i.config.thumbnailer.cssID=i.config.cssID,i.config.thumbnailer.initValues={width:n.width(),height:n.height()},i.config.thumbnailer.initValues.vertical=n.width()<=n.height(),n.bind("tn_click",function(e){i.show(e.n)}).bind("tn_over",function(){i.timer.pause(!0)}).bind("tn_out",function(){i.timer.pause(!1)}).bind("tn_error",function(e){i.trigger("error",e)});break;case"image":i.config.image.cssID=i.config.cssID,i.config.image.initValues={width:n.width(),height:n.height()},n.bind("img_click",function(e){switch(i.config.imageClick){case"next":i.show("next");break;case"fullscreen":i.fullscreen();break;case"url":if(e=i.data[i.cAlbum].imgs[e.n].url)window.location=e}}).bind("img_load_start",function(){i.items.preloader&&i.items.preloader.show()}).bind("img_load_end",function(e){i.n=e.n,i.items.thumbs&&i.thumbnailer.thumbClick(e.n),i.items.preloader&&i.items.preloader.hide(),i.items.timer&&i.items.timer.hide(),i.$inImage&&i.$inImage.hide()}).bind("img_transition",function(e){i.setTextValues(!1,"image"),i.$inImage&&i.imager.cached[e.n].isImage&&i.$inImage.fadeIn(300),i.items.count&&i.items.count.text(i.n+1+"/"+i.data[i.cAlbum].imgs.length),i.isPlaying&&i.timer.start(),i.special.o.length>0&&i.hideElements()}).bind("img_enter",function(){i.items.timer&&i.config.timerOverStop&&i.timer.pause(!0),i.special.o.length>0&&i.showElements(300)}).bind("img_leave",function(){i.items.timer&&i.config.timerOverStop&&i.timer.pause(!1),i.special.o.length>0&&i.hideElements(300)}).bind("img_resize",function(e){i.$inImage&&(i.$inImage.width(e.w).height(e.h).css("left",e.left).css("top",e.top),i.center(),i.imager.bindMouseEvents(i.$inImage))}).bind("img_error",function(e){i.trigger("error",e)});break;case"preloader":n.hide();break;case"timer":var r=n.width()>n.height()?"width":"height";i.$c.bind("timer_tick",function(e){if(i.config.timerMode=="char"){for(var t=i.config.timerStepChar;--e.tick;)t+=i.config.timerStepChar;i.items.timer.html(t)}else i.items.timer[r](i.timerSize/e.totalTicks*e.tick);i.trigger(e.type,e)}).bind("timer_start",function(e){i.timerSize=i.$inImage[r](),i.items.timer.fadeIn(300),i.trigger(e.type,e)}).bind("timer_end timer_stop",function(e){i.items.timer.hide(),i.trigger(e.type,e)}),n.hide();break;case"play":n.click(function(e){var t={id:"play",execute:!0};i.trigger("control",t),i.isPlaying?(t.execute&&(i.timer.stop(),n.removeClass(i.config.cssID+"-play-active"),n.attr("title",i.t("Start Slideshow"))),i.isPlaying=!1):(t.execute&&(i.timer.start(),n.addClass(i.config.cssID+"-play-active"),n.attr("title",i.t("Stop Slideshow"))),i.isPlaying=!0),e.stopPropagation()}),n.attr("title",i.t("Start Slideshow")),i.config.autoplay&&n.click();break;case"albums":i.albums=new e.fn.tn3.Albums(i.data,n,i.config.cssID),n.hide(),n.bind("albums_binit",function(e){i.trigger(e.type,e)}).bind("albums_click",function(e){i.showAlbum(e.n),i.trigger(e.type,e)}).bind("albums_init",function(e){i.timer.pause(!0),i.trigger(e.type,e)}).bind("albums_error",function(e){i.trigger("error",e)}).bind("albums_close",function(){i.timer.pause(!1)});break;case"albums-next":i.albums&&i.albums.setControl("next",n),n.attr("title",i.t("Next Album Page"));break;case"albums-prev":i.albums&&i.albums.setControl("prev",n),n.attr("title",i.t("Previous Album Page"));break;case"albums-close":i.albums&&i.albums.setControl("close",n),n.attr("title",i.t("Close"));break;case"show-albums":n.click(function(e){i.items.albums&&i.albums.show(0,i.cAlbum,!1,!0),e.stopPropagation()}),n.attr("title",i.t("Album List"));break;case"fullscreen":n.click(function(e){var t={id:"fullscreen",execute:!0};i.trigger("control",t),t.execute&&i.fullscreen(),e.stopPropagation()}),n.attr("title",i.t("Maximize"))}});if(this.config.width!==null||this.config.height!==null)this.config.width==null&&(this.config.width=this.config.initValues.width),this.config.height==null&&(this.config.height=this.config.initValues.height),this.resize(this.config.width,this.config.height);r=Math.min(this.config.iniAlbum,this.data.length-1),this.config.responsive!==!1&&this.initResponsive(this.config.responsive),this.initialized=!0,this.config.startWithAlbums&&this.data.length>1&&this.items.albums?this.albums.show():this.showAlbum(r,this.config.iniImage),this.config.isFullScreen&&this.onFullResize(e(window).width(),e(window).height()),this.trigger("init")}},parseLayout:function(){var t=this.items={},n=this.config,r=n.active,i=n.inactive,s=n.cssID.length+1,o=this,u,a;this.$c.find("div[class^='"+n.cssID+"-']").each(function(){u=e(this),a=u.attr("class").split(" ")[0].substr(s),e.inArray(a,i)!=-1?u.remove():r.length==0||e.inArray(a,r)!=-1?t[a]=u:a!="gallery"&&u.remove();if(u.parent().hasClass(n.cssID+"-image")){if(!o.$inImage){o.$inImage=e('<div class="tn3-in-image"></div>'),u.parent().append(o.$inImage);if(e.browser.msie){var l=e("<div />");l.css("background-color","#fff").css("opacity",0).css("width","100%").css("height","100%"),l.appendTo(o.$inImage)}o.$inImage.css("position","absolute").width(t.image.width()).height(t.image.height())}u.appendTo(o.$inImage)}this.className.indexOf("tn3_")!=-1&&o.addSpecial(a,this.className)}),$cm=this.$c,e.each(["albums","album","album-next","album-prev","show-albums","timer"],function(e,r){delete t[r],$cm.find("."+n.cssID+"-"+r).remove()});var l=e('<div title="Powered by TN3 Gallery"></div>');l.css("position","absolute").css("background-image","url('"+this.config.skinDir+"/tn3.png')").css("background-position","-258px -7px").css("bottom","14px").css("right","53px").css("cursor","pointer").width(40).height(18),l.appendTo(this.$c.find("."+n.cssID+"-gallery")),l.click(function(){window.location="http://tn3gallery.com"}).hover(function(){e(this).css("background-position","-258px -45px")},function(){e(this).css("background-position","-258px -7px")})},addSpecial:function(e,t){for(var n=t.split(" "),r,i=0;i<n.length;i++){r=n[i].split("_");if(r[0]=="tn3"){this.special[r[1]].push(e);if(r[1]=="rh"||r[1]=="rv")this.config.initValues[e]={w:this.items[e].width(),h:this.items[e].height()}}}},initHover:function(e,t){var n=this;e.hover(function(){e.addClass(n.config.cssID+"-"+t+"-over")},function(){e.removeClass(n.config.cssID+"-"+t+"-over")})},setTextValues:function(t,n){var r,i,s,o=n+"-";for(s in this.items)s.indexOf(o)==0&&(r=s.substr(o.length),r!="info"&&r!="prev"&&r!="next"&&(i=n=="image"?this.data[this.cAlbum].imgs[this.n]:this.data[this.cAlbum],!i||i[r]==undefined?(i={},i[r]=""):i[r]=e.trim(i[r]),r={field:r,text:i[r],data:i},this.trigger("set_text",r),t||r.text==undefined||r.text.length==0?(this.items[s].html(""),this.items[s].hide()):(this.items[s].html(r.text),this.items[s].show())))},show:function(e,t){this.timer.stop(),this.imager&&this.imager.show(e),t&&this.fullscreen()},setAlbumData:function(e,t){if(t)this.trigger("error",{description:t});else{for(var n=0,r=e.length;n<r;n++)this.data.push(e[n]);this.$c&&this.init(this.$c,this.config.fullOnly)}},setImageData:function(e,t,n){n?this.trigger("error",{description:n}):(this.items.preloader&&this.items.preloader.hide(),e={data:e},this.trigger("image_data",e),this.data[t].imgs=e.data,this.cAlbum==t&&this.rebuild(e.data,t==0?this.config.iniImage:0))},showAlbum:function(e,t,n){if(this.initialized){if(e>this.data.length)return;this.timer.stop(),this.cAlbum=e,this.albums&&this.albums.hide(),this.data[this.cAlbum].imgs===undefined?this.loader?(this.loader.getImages(this.data[this.cAlbum].adata,this.cAlbum),this.items.preloader&&this.items.preloader.show()):this.trigger("error",{description:"Wrong album id"}):this.rebuild(this.data[this.cAlbum].imgs,t)}else this.config.iniAlbum=e,this.config.iniImage=t,this.init(this.$c,!1);n&&this.fullscreen()},rebuild:function(t,n){this.items.thumbs&&(this.thumbnailer?this.thumbnailer.rebuild(t):this.thumbnailer=new e.fn.tn3.Thumbnailer(this.items.thumbs,t,this.config.thumbnailer)),this.items.image&&(this.imager?this.imager.rebuild(t):this.imager=new e.fn.tn3.Imager(this.items.image,t,this.config.image)),this.setTextValues(!0,"image"),this.setTextValues(!1,"album"),this.show(n==null?0:n),this.trigger("rebuild",{album:this.cAlbum})},showElements:function(t){if(this.areHidden){var n=this,r;e.each(this.special.o,function(i,s){r=n.items[s],r.show(),t&&e.support.opacity&&(r.stop(!0),r.css("opacity",0),r.animate({opacity:1},{duration:t,queue:!1}))}),this.areHidden=!1}},hideElements:function(t){if(!this.areHidden){var n=this,r;e.each(this.special.o,function(i,s){r=n.items[s],t&&e.support.opacity?(r.stop(!0),r.animate({opacity:0},{duration:t,complete:function(){r.hide()},queue:!1})):r.hide()}),this.areHidden=!0}},setData:function(e){this.items.thumbs&&(this.thumbnailer.data=e),this.items.imager&&(this.imager.data=e)},fullscreen:function(){this.config.isFullScreen?(e(window).unbind("resize",this.onFullResize),e.tn3unblock(),this.config.responsive!==!1?this.initResponsive(this.config.responsive):this.config.width!==null||this.config.height!==null?this.resize(this.config.width,this.config.height):this.resize(this.config.initValues.width,this.config.initValues.height),this.items.fullscreen&&(this.items.fullscreen.removeClass(this.config.cssID+"-fullscreen-active"),this.items.fullscreen.attr("title",this.t("Maximize"))),this.config.fullOnly&&this.$c.hide(),this.config.isFullScreen=!1,this.trigger("fullscreen",{fullscreen:!1}),this.config.keyNavigation=="fullscreen"&&e(document).unbind("keyup",this.listenKeys)):(e.tn3block({message:this.$tn3,cssID:this.config.cssID}),e(window).bind("resize",e.proxy(this.onFullResize,this)),this.config.fullOnly&&this.$c.show(),this.config.isFullScreen=!0,this.items.fullscreen&&(this.items.fullscreen.addClass(this.config.cssID+"-fullscreen-active"),this.items.fullscreen.attr("title",this.t("Minimize"))),this.onFullResize(),this.trigger("fullscreen",{fullscreen:!0}))},listenKeys:function(e){if(e.keyCode==70)this.items.fullscreen.click();else if(this.items.albums&&this.albums.enabled){var t=0;switch(e.keyCode){case 27:this.albums.hide();break;case 39:t="r";break;case 37:t="l";break;case 38:t="u";break;case 40:t="d";break;case 32:t="p"}t&&this.albums.select(t)}else switch(e.keyCode){case 27:this.config.isFullScreen&&this.fullscreen();break;case 39:this.show("next");break;case 37:this.show("prev");break;case 38:this.items.albums&&this.albums.show(0,this.cAlbum,!1,!0);break;case 32:this.items.play.click()}},onFullResize:function(){var t=e(window),n=t.width();t=t.height(),n-=this.config.initValues.wDif,t-=this.config.initValues.hDif,this.resize(n,t)},resize:function(t,n){this.$tn3.width(t).height(n);var r=t-this.config.initValues.width,i=n-this.config.initValues.height,s,o,u=this;this.items.image&&(s=this.config.image.initValues.width+r,o=this.config.image.initValues.height+i,this.imager?this.imager.setSize(s,o):(this.items.image.width(s).height(o),this.$inImage.width(s).height(o))),this.items.thumbs&&(s=this.config.thumbnailer.initValues.width+r,o=this.config.thumbnailer.initValues.height+i,this.thumbnailer?this.thumbnailer.setSize(s,o):this.config.thumbnailer.initValues.vertical?this.items.thumbs.height(o):this.items.thumbs.width(s)),this.items.albums&&(s=this.albums.initValues.width+r,o=this.albums.initValues.height+i,this.albums.changeSize(r,i)),e.each(this.special.rh,function(e,t){u.items[t].width(u.config.initValues[t].w+r)}),e.each(this.special.rv,function(e,t){u.items[t].height(u.config.initValues[t].h+i)}),this.center()},center:function(){var t,n=this,r=n.items.image.position();e.each(this.special.v,function(e,r){t=n.items[r],t.css("top",(t.parent().height()-t.height())/2)}),e.each(this.special.h,function(e,r){t=n.items[r],t.css("left",(t.parent().width()-t.width())/2)}),e.each(this.special.vi,function(e,i){t=n.items[i],t.css("top",r.top+(n.items.image.height()-t.height())/2)}),e.each(this.special.hi,function(e,i){t=n.items[i],t.css("left",r.left+(n.items.image.width()-t.width())/2)})},trigger:function(t,n){var r=e.Event("tn3_"+t),i;for(i in n)r[i]=n[i];n&&n.type!=undefined&&(r.type="tn3_"+t),r.source=this,this.$c.trigger(r),this.config[t]&&this.config[t].call(this,r);for(i in n)n[i]=r[i]},initMouseWheel:function(){var e=this,t=function(t){e.show((t.originalEvent.detail?-t.originalEvent.detail:t.originalEvent.wheelDelta)>0?"prev":"next"),t.preventDefault()};this.$tn3.bind("mousewheel",t),this.$tn3.bind("DOMMouseScroll",t)},initResponsive:function(t){var n;if(typeof t=="number"){var r=e(window);n=function(){var e=r.width(),n=r.height();this.resize(e*t/100,n*t/100)}}else if(e.isFunction(t))n=t;else if(t!==!1){var i=this.$c.parent(),s=(this.config.width==null?this.config.initValues.width:this.config.width)/(this.config.height==null?this.config.initValues.height:this.config.height),o=i.width(),u=i.height();n=t=="enabled"?function(){o=i.width(),u=i.height(),this.resize(o,u)}:t=="height"?function(){u=i.height(),o=u*s,this.resize(o,u)}:function(){o=i.width(),u=o/s,this.resize(o,u)}}e(window).bind("resize",e.proxy(n,this)),e.proxy(n,this)()},replaceMenu:function(t,n){var r='<div style="position:absolute;background-color:#fff;color: #000;padding:0px 4px 0px 4px;z-index:1010;font-family:sans-serif;font-size:12px;">&copy; <a href="'+n+'">'+t+"</a></div>";this.$tn3.bind("contextmenu",function(e){e.preventDefault()}).bind("mousedown",function(t){if(t.which==3){var i=e(r);e("body").append(i),i.css("left",t.pageX).css("top",t.pageY),i.find("a").mouseup(function(e){window.location=n,i.unbind(e)}),e("body").mouseup(function(t){i.remove(),e("body").unbind(t)})}})}}}(jQuery),function(e){e.fn.tn3.Imager=function(t,n,r){this.$c=t,this.data=n,r.crop=!1,this.config=e.extend(!0,{},e.fn.tn3.Imager.config,r),this.init()},e.fn.tn3.Imager.config={transitions:null,defaultTransition:{type:"slide"},random:!1,cssID:"tn3",maxZoom:1.4,crop:!1,clickEvent:"click",idleDelay:3e3,stretch:!0,dif:0},e.fn.tn3.Imager.prototype={config:null,$c:!1,data:!1,cached:null,active:-1,$active:!1,$buffer:!1,isInTransition:!1,ts:null,cDim:null,qid:null,currentlyLoading:null,side:null,$ic:null,$binder:null,infoID:null,lastEnter:!1,mouseCoor:{x:0,y:0},mouseIsOver:!1,init:function(){this.$c.css("overflow","hidden"),this.$c.css("position","relative"),this.bindMouseEvents(this.$c),this.cached=[],this.ts=new e.fn.tn3.Transitions(this.config.transitions,this.config.defaultTransition,this.config.random,this,"onTransitionEnd")},bindMouseEvents:function(t){this.unbindMouseEvents();var n=this;t.hover(function(){n.mouseIsOver=!0,n.enterLeave("enter"),n.startIdle(),e(document).mousemove(e.proxy(n.onMouseMove,n))},function(){n.mouseIsOver=!1,n.enterLeave("leave"),n.stopIdle(),e(document).unbind("mousemove",n.onMouseMove)}),t[this.config.clickEvent](function(e){n.active==-1||n.isInTransition||e.target.tagName.toUpperCase()!="A"&&n.trigger("click",{n:n.active})}),this.$binder=t},unbindMouseEvents:function(){this.$binder&&this.$binder.unbind("mouseenter mouseleave "+this.config.clickEvent),e(document).unbind("mousemove",this.onMouseMove),this.stopIdle()},startIdle:function(){this.stopIdle();var e=this;this.config.idleDelay>0&&(this.infoID=setTimeout(function(){e.enterLeave("leave"),e.stopIdle()},this.config.idleDelay))},onMouseMove:function(e){this.mouseCoor={x:e.pageX,y:e.pageY},this.isInTransition||(this.infoID||this.enterLeave("enter"),this.startIdle())},stopIdle:function(){clearTimeout(this.infoID),this.infoID=null},enterLeave:function(e){this.lastEnter!=e&&this.trigger(e),this.lastEnter=e},show:function(t){this.isInTransition?this.qid=t:(this.qid=null,t=="next"?(t=this.active+1<this.data.length?this.active+1:0,this.side="left"):t=="prev"?(t=this.active>0?this.active-1:this.data.length-1,this.side="right"):this.side=this.active>t?"right":"left",this.data[t]&&(this.trigger("load_start",{n:t}),this.$buffer=e('<div class="'+this.config.cssID+'-image-in" style="position:absolute;overflow:hidden;"></div>'),this.$c.prepend(this.$buffer),this.cached[this.currentlyLoading]!=undefined&&(this.cached[this.currentlyLoading].init=!1),this.cached[t]!=undefined?this.cached[t].status=="loaded"?this.initImage(t):(this.cached[t].init=!0,this.currentlyLoading=t):this.startLoading(t,!0)))},startLoading:function(t,n){this.cached[t]={isImage:!0,status:"loading",init:n},this.currentlyLoading=t,this.data[t].content!=undefined?(this.cached[t].isImage=!1,this.onCacheLoad(e(this.data[t].content),t)):this.cached[t].loader=new e.fn.tn3.ImageLoader(this.data[t].img,this,this.onCacheLoad,[t])},onCacheLoad:function(e,t,n){this.cached[t].status="loaded",this.cached[t].$content=e,n&&this.trigger("error",{description:n,n:t}),this.cached[t].init&&this.initImage(t)},initImage:function(t){var n=this.cached[t].$content;this.currentlyLoading=null,this.active=t,this.cDim||(this.cDim={w:this.$c.width(),h:this.$c.height()}),this.$buffer.width(this.cDim.w).height(this.cDim.h);var r=e('<div class="'+this.config.cssID+'-full-image" style="position:absolute"></div>');n.appendTo(r),this.$buffer.append(r),this.$buffer.data("ic",r),this.$buffer.data("img",n),this.resize(this.$buffer),this.trigger("load_end",{n:t,content:n,isImage:this.cached[t].isImage}),this.$active!=0?(this.isInTransition=!0,this.unbindMouseEvents(),this.mouseIsOver?e(document).mousemove(e.proxy(this.onMouseMove,this)):this.mouseCoor={x:0,y:0},this.lastEnter="leave",this.ts.start(this.$active,this.$buffer,this.side)):(this.$active=this.$buffer,this.trigger("transition",{n:this.active})),this.cached[t+1]==undefined&&this.data[t+1]!=undefined&&this.startLoading(t+1,!1)},setSize:function(e,t){this.isInTransition&&this.ts.stop(this.$active,this.$buffer,this.ts.config),this.$c.width(e).height(t),this.cDim={w:this.$c.width(),h:this.$c.height()},this.$active&&(this.$active.width(e).height(t),this.resize(this.$active))},resize:function(e){e.data("img")==undefined?this.trigger("resize",{w:this.cDim.w,h:this.cDim.h,left:0,top:0}):this.cached[this.active].isImage?this.resizeImage(e):this.resizeContent(e)},resizeImage:function(e){$img=e.data("img"),$ic=e.data("ic"),$img.width("auto").height("auto"),e.data("scaled",!1);var t=$img.width(),n=$img.height(),r=0,i=0,s={w:t,h:n,left:0,top:0};$img.attr("width",t).attr("height",n),$img.get(0).tagName.toUpperCase()=="IMG"&&(t!=this.cDim.w||n!=this.cDim.h)&&(r=this.cDim.w/t,i=this.cDim.h/n,r=this.config.crop?Math.max(r,i):Math.min(r,i),r=Math.min(this.config.maxZoom,r),t=s.w=Math.round(t*r)-this.config.dif,n=s.h=Math.round(n*r)-this.config.dif,this.cDim.w>=t?r=s.left=(this.cDim.w-t)/2:(r=-(t-this.cDim.w)*.5,s.w=this.cDim.w),this.cDim.h>n?i=s.top=(this.cDim.h-n)/2:(i=-(n-this.cDim.h)*.5,s.h=this.cDim.h),$img.width(t).height(n),$img.attr("width",t).attr("height",n),$ic.width(t).height(n),e.data("scaled",!0)),$ic.css("left",r).css("top",i),this.bindMouseEvents($ic),this.trigger("resize",s)},resizeContent:function(e){$ic=e.data("ic"),$img=e.data("img"),e.data("scaled",!1);var t=$img.width(),n=$img.height(),r={w:t,h:n,left:0,top:0};this.config.stretch?($ic.width(this.cDim.w).height(this.cDim.h),$img.width(this.cDim.w).height(this.cDim.h),e.data("scaled",!0)):(r.left=(this.cDim.w-t)*.5,r.top=(this.cDim.h-n)*.5,$ic.css("left",r.left).css("top",r.top)),this.bindMouseEvents($ic),this.trigger("resize",r)},onTransitionEnd:function(){this.$active.remove(),this.$active=this.$buffer,this.isInTransition=!1,this.trigger("transition",{n:this.active}),this.bindMouseEvents(this.$binder);var t=this.$binder.offset();this.mouseIsOver=!1,this.mouseCoor.x>=t.left&&this.mouseCoor.x<=t.left+this.$binder.width()&&this.mouseCoor.y>=t.top&&this.mouseCoor.y<=t.top+this.$binder.height()&&(this.lastEnter="leave",this.enterLeave("enter"),this.startIdle(),this.mouseIsOver=!0,e(document).mousemove(e.proxy(this.onMouseMove,this))),this.qid!=null&&this.show(this.qid)},trigger:function(t,n){var r=e.Event("img_"+t),i;for(i in n)r[i]=n[i];r.source=this,this.$c.trigger(r),this.config[t]&&this.config[t].call(this,r)},destroy:function(){this.isInTransition&&this.ts.stop(this.$active,this.$buffer),this.$active&&this.$active.remove(),this.$buffer.remove()},rebuild:function(e){this.quid=null,this.isInTransition&&this.ts.stop(this.$active,this.$buffer),this.$buffer&&this.$buffer.remove(),this.cached=[],this.data=e,this.loader&&this.loader.cancel()}}}(jQuery),function(e){e.fn.tn3.Thumbnailer=function(t,n,r){this.$c=t,this.data=n,this.config=e.extend({},e.fn.tn3.Thumbnailer.config,r),e(window).resize(e.proxy(this.onWinResize,this)),this.init()},e.fn.tn3.Thumbnailer.config={overMove:!0,buffer:20,speed:8,slowdown:50,shaderColor:"#000000",shaderOpacity:.5,shaderDuration:300,shaderOut:300,useTitle:!1,seqLoad:!0,align:1,mode:"thumbs",cssID:"tn3"},e.fn.tn3.Thumbnailer.prototype={config:null,$c:null,$oc:null,$ul:null,data:null,active:-1,listSize:0,containerSize:0,containerPadding:0,noBufSize:0,containerOffset:0,mcoor:"mouseX",edge:"left",size:"width",outerSize:"outerWidth",mouseX:0,mouseY:0,intID:!1,pos:0,difference:0,cnt:1,thumbCount:-1,initialized:!1,clickWhenReady:-1,loaders:null,lis:null,isVertical:null,marginDif:0,nloaded:0,firstToLoad:0,init:function(){this.$c.css("position","absolute").css("cursor","progress"),this.lis=[],this.loaders=[],this.initialized=!1,this.$oc=e("<div />"),this.$ul=e("<ul />"),this.$oc.appendTo(this.$c),this.$oc.css("position","absolute").css("overflow","hidden").width(this.$c.width()).height(this.$c.height()),this.$ul.appendTo(this.$oc),this.$ul.css("position","relative").css("margin","0px").css("padding","0px").css("border-width","0px").css("width","12000px").css("list-style","none"),this.isVertical==null&&(this.isVertical=this.$c.width()<this.$c.height(),(this.isVertical=!1)?(this.mcoor="mouseY",this.edge="top",this.size="height",this.outerSize="outerHeight"):(this.mcoor="mouseX",this.edge="left",this.size="width",this.outerSize="outerWidth"),this.containerSize=this.$oc[this.size](),this.noBufSize=this.containerSize-2*this.config.buffer,this.containerOffset=this.$oc.offset()[this.edge],this.containerPadding=parseInt(this.$c.css("padding-"+this.edge))),this.listSize=0,navigator.userAgent.indexOf("MSIE")!=-1&&(this.config.seqLoad=!1),this.data.length>0&&this.loadNextThumb()},loadNextThumb:function(){this.thumbCount++;var t=e("<li></li>");this.$ul.append(t);if(this.config.mode=="thumbs"){var n=this.data[this.thumbCount].thumb;if(n){this.loaders.push(new e.fn.tn3.ImageLoader(n,this,this.onLoadThumb,[t,this.thumbCount])),!this.config.seqLoad&&this.thumbCount<this.data.length-1&&this.loadNextThumb();return}this.config.mode="bullets"}this.config.mode=="numbers"&&t.text(this.thumbCount+1),this.onLoadThumb(null,t,this.thumbCount)},onLoadThumb:function(t,n,r,i){this.lis[r]={li:n},n.addClass(this.config.cssID+"-thumb"),n.css("float",this.isVertical?"none":"left");if(t){var s=this.lis[r].thumb=e(t);n.append(s),this.lis[r].pos=n.position()[this.edge]}this.config.useTitle&&n.attr("title",this.data[r].title.replace(/\&amp;/g,"&")),this.config.mode=="thumbs"&&
(this.lis[r].shade=e("<div/>"),n.prepend(this.lis[r].shade),this.lis[r].shade.css("background-color",this.config.shaderColor).css("width",s.width()).css("height",s.height()).css("position","absolute")),this.initThumb(r),n.css("opacity",0),n.animate({opacity:1},1e3),this.listSize+=n[this.outerSize](!0),this.initialized||(this.firstToLoad=r,this.initialized=!0,this.initMouse(!0)),i&&this.trigger("error",{description:i,n:r}),this.trigger("thumbLoad",{n:r}),this.nloaded++;if(this.nloaded<this.data.length)(this.config.seqLoad||this.config.mode!="thumbs")&&this.loadNextThumb();else{t&&(this.loaders=null);if(!this.config.seqLoad)for(t=0;t<this.lis.length;t++)this.lis[t].pos=this.lis[t].li.position()[this.edge];this.thumbsLoaded()}this.clickWhenReady==r&&(this.clickWhenReady=-1,this.thumbClick(r))},initThumb:function(e){var t=this.lis[e];if(t.li){t.li.removeClass().addClass(this.config.cssID+"-thumb"),t.shade&&(t.shade.stop(),t.shade.css("opacity",this.config.shaderOpacity));var n=this;t.li.click(function(){return n.thumbClick(e),n.trigger("click",{n:e}),!1}),this.config.mode!="thumbs"&&t.li.hover(function(){n.mouseOver(e)},function(){n.mouseOver(-1)})}},lastOver:-1,mouseOver:function(e){if(e!=this.lastOver){this.lastOver!=-1&&this.lastOver!=this.active&&(t=this.lis[this.lastOver],t.li.removeClass(this.config.cssID+"-thumb-over"),t.shade&&(t.shade.stop(),t.shade.animate({opacity:this.config.shaderOpacity},{duration:this.config.shaderOut,easing:"easeOutCubic",queue:!1})),this.trigger("thumbOut",{n:e})),this.lastOver=e;if(e!=-1&&e!=this.active){var t=this.lis[e];t.li.addClass(this.config.cssID+"-thumb-over"),t.shade&&(t.shade.stop(),t.shade.animate({opacity:0},{duration:this.config.shaderDuration,easing:"easeOutCubic",queue:!1})),this.trigger("thumbOver",{n:e})}}},next:function(e){if(e)this.listSize>this.containerSize&&this.move(this.$ul.position()[this.edge]-this.containerSize);else{e=this.active+1;if(this.active==-1||this.active+1==this.data.length)e=0;this.thumbClick(e)}},prev:function(e){if(e)this.listSize>this.containerSize&&this.move(this.$ul.position()[this.edge]+this.containerSize);else{e=this.active-1;if(this.active==-1||this.active==0)e=this.data.length-1;this.thumbClick(e)}},move:function(e){var t={};t[this.edge]=Math.min(0,Math.max(e,-(this.listSize-this.containerSize))),this.$ul.stop(),this.$ul.animate(t,300)},thumbClick:function(e){if(this.active==-1){if(this.thumbCount<=e||this.lis.length<=e||this.lis[e]==null){this.clickWhenReady=e;return}}else{if(e==this.active)return;this.initThumb(this.active)}e=="next"?e=this.active+1<this.data.length?this.active+1:0:e=="prev"&&(e=this.active>0?this.active-1:this.data.length-1);var t=this.lis[e];t.li.addClass(this.config.cssID+"-thumb-selected").unbind("click mouseenter mouseleave"),t.shade&&t.shade.animate({opacity:0},this.config.shaderDuration),this.active=e,this.centerActive()},centerActive:function(e){if(this.active!=-1){var t=this.lis[this.active].li,n=this.$ul.position()[this.edge]+t.position()[this.edge],r=t[this.outerSize]()/2;if(n+r>this.containerSize||n+r<0)t=10-t.position()[this.edge]+this.containerSize/2-r,t=Math.min(0,t),t=Math.max(t,-this.listSize+this.containerSize),n={},n[this.edge]=t,e?this.$ul.css(n):this.$ul.animate(n,200)}},thumbsLoaded:function(){this.$c.css("cursor","auto"),this.$ul.css("width",this.listSize+"px"),this.centerList(),this.trigger("load")},centerList:function(e){if(this.listSize<this.containerSize){var t={};t[this.edge]=this.config.align?this.config.align==1?(this.containerSize-this.listSize)/2:this.containerSize-this.listSize:0,e||this.config.mode!="thumbs"?this.$ul.css(t):this.$ul.animate(t,300)}else this.centerActive(e),this.$ul.position()[this.edge]>0?this.$ul.css(this.edge,0):this.$ul.position()[this.edge]+this.listSize<this.containerSize&&this.$ul.css(this.edge,-(this.listSize-this.containerSize))},initMouse:function(t){this.config.mode=="thumbs"&&(t=t?"bind":"unbind",this.$oc[t]("mouseenter",e.proxy(this.mouseenter,this)),this.$oc[t]("mouseleave",e.proxy(this.mouseleave,this)))},mouseenter:function(){this.trigger("over"),clearInterval(this.intID);var e=this;this.$ul.stop(),this.$c.mousemove(this.mcoor=="mouseX"?function(t){e.mouseX=t.pageX-e.containerOffset}:function(t){e.mouseY=t.pageY-e.containerOffset}),this.marginDif=parseInt(this.lis[this.firstToLoad].li.css("margin-"+this.edge)),isNaN(this.marginDif)&&(this.marginDif=0),e.intID=this.listSize>this.containerSize&&this.config.overMove?setInterval(function(){e.slide.call(e)},10):setInterval(function(){e.mouseTrack.call(e)},10)},mouseleave:function(){this.trigger("out"),this.$c.unbind("mousemove"),clearInterval(this.intID);var e=this;this.intID=setInterval(function(){e.slideOut.call(e)},10),this.mouseOver(-1)},slide:function(){this.cnt=1;var e=this[this.mcoor];if(e<=this.config.buffer)this.pos=0;else if(e>=this.containerSize-this.config.buffer)this.pos=this.containerSize-this.listSize-1;else{var t=this.containerSize*(e-this.config.buffer);t/=this.noBufSize,this.pos=t*(1-this.listSize/this.containerSize)}for(t=this.lis.length-1;t>-1;t--){var n=e-this.prevdx;if(n>=this.lis[t].pos&&n<this.lis[t].pos+this.lis[t].li.width()){this.mouseOver(t);break}}e=this.prevdx-this.marginDif,this.difference=e-this.pos,e=Math.round(e-this.difference/this.config.speed),this.prevdx!=e&&(this.$ul.css(this.edge,e),this.prevdx=e)},prevdx:0,mouseTrack:function(){for(var e=this[this.mcoor],t=this.lis.length-1;t>-1;t--){var n=e-this.$ul.position()[this.edge];if(n>=this.lis[t].pos&&n<this.lis[t].pos+this.lis[t].li.width()){this.mouseOver(t);break}}},slideOut:function(){if(this.config.slowdown!=0&&this.difference!=0){var e=this.$ul.position()[this.edge];this.difference=e-this.pos,this.$ul.css(this.edge,e-this.difference/(this.config.speed*this.cnt)),this.cnt*=1+4/this.config.slowdown,this.cnt>=40&&(this.difference=0,this.cnt=1)}else clearInterval(this.intID),this.intID=null},trigger:function(t,n){var r=e.Event("tn_"+t),i;for(i in n)r[i]=n[i];r.source=this,this.$c.trigger(r),this.config[t]&&this.config[t].call(this,r)},destroy:function(){clearInterval(this.intID),this.$c.empty()},rebuild:function(t){clearInterval(this.intID),this.$c.empty(),this.data=t,this.active=this.thumbCount=-1,this.nloaded=0,this.initMouse(!1),this.loaders!==null&&e.each(this.loaders,function(e,t){t.cancel()}),this.init()},setSize:function(e,t){this.config.mode=="thumbs"&&(this.isVertical?this.$c.height(t):this.$c.width(e),this.$oc.width(this.$c.width()).height(this.$c.height()),this.containerSize=this.$oc[this.size](),this.noBufSize=this.containerSize-2*this.config.buffer,this.containerOffset=this.$oc.offset()[this.edge],this.initMouse(!0),this.loaders===null&&this.centerList(!0))},onWinResize:function(){this.containerOffset=this.$oc.offset()[this.edge]}}}(jQuery),function(e){e.fn.tn3.altLink=null,e.fn.tn3.ImageLoader=function(t,n,r,i){this.$img=e(new Image),i.unshift(this.$img),this.altLink=e.fn.tn3.altLink,n={url:t,context:n,callback:r,args:i},this.$img.bind("load",n,this.load),this.$img.bind("error",n,e.proxy(this.error,this)),this.$img.attr("src",t)},e.fn.tn3.ImageLoader.prototype={$img:null,altLink:null,load:function(e){e.data.callback.apply(e.data.context,e.data.args),e.data.args[0].unbind("load").unbind("error")},error:function(t){this.altLink?(this.altLink=null,this.$img.attr("src",e.fn.tn3.altLink+t.data.url)):(t.data.args.push("image loading error: "+t.data.url),t.data.callback.apply(t.data.context,t.data.args),this.$img.unbind("load").unbind("error"))},cancel:function(){this.$img.unbind("load").unbind("error")}}}(jQuery),function(e){e.fn.tn3.Timer=function(e,t,n){this.$target=e,this.duration=t,this.tickint=n},e.fn.tn3.Timer.prototype={$target:null,duration:null,id:null,runs:!1,counter:null,countDuration:null,tickid:null,ticks:null,tickint:500,start:function(){this.runs||(this.runs=!0,this.startCount(this.duration),this.trigger("timer_start"))},startCount:function(e){this.clean(),this.countDuration=e,this.counter=+(new Date);var t=this;this.id=setTimeout(function(){t.clean.call(t),t.runs=!1,t.trigger.call(t,"timer_end")},e);var n=this.duration/this.tickint;this.ticks=Math.round(e/n),this.tickid=setInterval(function(){t.ticks=Math.ceil((e-new Date+t.counter)/n),t.ticks>0&&t.trigger.call(t,"timer_tick",{tick:t.ticks,totalTicks:t.tickint})},n),this.trigger("timer_tick",{tick:this.ticks,totalTicks:this.tickint})},stop:function(){this.clean(),this.runs=!1,this.trigger("timer_stop")},clean:function(){clearTimeout(this.id),this.id=null,clearInterval(this.tickid),this.elapsed=this.tickid=null},elapsed:null,pause:function(e){if(this.runs){if(e){this.clean();var t=this.duration/this.tickint;this.elapsed=Math.floor((+(new Date)-this.counter)/t)*t}else{if(this.elapsed==null)return;this.startCount(this.countDuration-this.elapsed),this.elapsed=null}this.trigger("timer_pause",{pause:e})}},trigger:function(t,n){var r=e.Event(t),i;for(i in n)r[i]=n[i];this.$target.trigger(r)}}}(jQuery),function(e){var t=e.fn.tn3.Transitions=function(t,n,r,i,s){this.ts=t,this.def=e.extend(!0,{},this[n.type+"Config"],n),t||(this.ts=[this.def]);for(var o in this.ts)this.ts[o]=e.extend(!0,{},this[this.ts[o].type+"Config"],this.ts[o]);this.random=r,this.end=e.proxy(i,s)},n=t.prototype={ts:null,def:{type:"slide"},random:!1,gs:[],end:null,ct:null,counter:-1,setTransition:function(){this.ts.length==1?this.ct=this.ts[0]:(this.counter++,this.counter==this.ts.length&&(this.counter=0),this.random&&this.counter==0&&e.fn.tn3utils.shuffle(this.ts),this.ct=this.ts[this.counter])},start:function(e,t,n){this.setTransition(),this[this.ct.type+"Condition"]!==undefined&&!this[this.ct.type+"Condition"](e,t,this.ct)&&(this.ct=this.def),this[this.ct.type](e,t,this.ct,n)},stop:function(e,t){this[this.ct.type+"Stop"](e,t,this.ct)},makeGrid:function(e,t,n){var r=e.width(),i=Math.round(r/t);r-=i*t;var s=e.height(),o=Math.round(s/n);s-=o*n;var u,a,f,l,c,h=0,p=0,d="url("+e.find("img").attr("src")+") no-repeat scroll -";for(u=0;u<t;u++){this.gs[u]=[],l=r>u?i+1:i;for(a=0;a<n;a++)f=e.append("<div></div>").find(":last"),c=s>a?o+1:o,f.width(l).height(c).css("background",d+h+"px -"+p+"px").css("left",h).css("top",p).css("position","absolute"),this.gs[u].push(f),p+=c;h+=l,p=0}e.find("img").remove()},stopGrid:function(){for(var e=0;e<this.gs.length;e++)for(var t=0;t<this.gs[e].length;t++)this.gs[e][t].clearQueue(),this.gs[e][t].remove();this.gs=[]},flatSort:function(e){for(var t=[],n=0;n<this.gs.length;n++)for(var r=0;r<this.gs[n].length;r++)t.push(this.gs[n][r]);return e&&t.reverse(),t},randomSort:function(){var t=this.flatSort();return e.fn.tn3utils.shuffle(t),t},diagonalSort:function(e,t){for(var n=[],r=e>0?this.gs.length-1:0,i=t>0?0:this.gs[0].length-1;this.gs[r];)n.push(this.addDiagonal([],r,i,e,t)),r-=e;r+=e;for(i+=t;this.gs[r][i];)n.push(this.addDiagonal([],r,i,e,t)),i+=t;return n},addDiagonal:function(e,t,n,r,i){return e.push(this.gs[t][n]),this.gs[t+r]&&this.gs[t+r][n+i]?this.addDiagonal(e,t+r,n+i,r,i):e},circleSort:function(e){var t=[],n=this.gs.length,r=this.gs[0].length,i=[Math.floor(n/2),Math.floor(r/2)];n*=r,r=[[1,0],[0,1],[-1,0],[0,-1]];var s=0,o=0,u;for(t.push(this.gs[i[0]][i[1]]);t.length<n;){for(u=0;u<=s;u++)this.addGridPiece(t,i,r[o]);o==r.length-1?o=0:o++,s+=.5}return e&&t.reverse(),t},addGridPiece:function(e,t,n){t[0]+=n[0],t[1]+=n[1],this.gs[t[0]]&&this.gs[t[0]][t[1]]&&e.push(this.gs[t[0]][t[1]])},getSlidePositions:function(e,t){var n={dir:t};switch(t){case"left":n.pos=e.outerWidth(!0);break;case"right":n.pos=-e.outerWidth(!0),n.dir="left";break;case"top":n.pos=-e.outerHeight(!0);break;case"bottom":n.pos=e.outerHeight(!0),n.dir="top"}return n},animateGrid:function(t,n,r,i,s,o,u){var a={duration:i,easing:r,complete:function(){e(this).remove()}};for(r=0;r<t.length;r++){i=e.easing[s](0,r,0,o,t.length);if(r==t.length-1){var l=this;a.complete=function(){e(this).remove(),u.call(l)}}if(e.isArray(t[r]))for(var c in t[r])t[r][c].delay(i).animate(n[r],a);else t[r].delay(i).animate(n[r],a)}},getValueArray:function(t,n,r){var i=[],s=e.isArray(n),u=e.isArray(r),a;for(a=0;a<t;a++)o={},o[s?n[a%n.length]:n]=u?r[a%r.length]:r,i.push(o);return i}};t.defined=[],t.define=function(e){for(var r in e)switch(r){case"type":t.defined.push(e.type);break;case"config":n[e.type+"Config"]=e.config;break;case"f":n[e.type]=e.f;break;case"stop":n[e.type+"Stop"]=e.stop;break;case"condition":n[e.type+"Condition"]=e.condition;break;default:n[r]=e[r]}},t.define({type:"none",config:{},f:function(){this.end()},stop:function(){this.end()}}),t.define({type:"fade",config:{duration:300,easing:"easeInQuad"},f:function(e,t,n){var r=this;e.animate({opacity:0},n.duration,n.easing,function(){r.end()})},stop:function(e){e.stop(),this.end()}}),t.define({type:"slide",config:{duration:300,direction:"auto",easing:"easeInOutCirc"},f:function(e,t,n,r){r=this.getSlidePositions(t,n.direction=="auto"?r:n.direction);var i={},s={};t.css(r.dir,r.pos),i[r.dir]=0,t.animate(i,n.duration,n.easing,this.end),s[r.dir]=-r.pos,e.animate(s,n.duration,n.easing)},stop:function(e,t){t.stop(),e.stop(),e.css("left",0).css("top",0),t.css("left",0).css("top",0),this.end()}}),t.define({type:"blinds",config:{duration:240,easing:"easeInQuad",direction:"vertical",parts:12,partDuration:100,partEasing:"easeInQuad",method:"fade",partDirection:"auto",cross:!0},f:function(e,t,n,r){n.direction=="horizontal"?this.makeGrid(e,1,n.parts):this.makeGrid(e,n.parts,1),r=n.partDirection=="auto"?r:n.partDirection,e=this.flatSort(r=="left"||r=="top");var i;switch(n.method){case"fade":i=this.getValueArray(e.length,"opacity",0);break;case"scale":i=this.getValueArray(e.length,r=="left"?"width":"height","1px");break;case"slide":t=this.getSlidePositions(t,r),i=this.getValueArray(e.length,t.dir,n.cross?[t.pos,-t.pos]:t.pos)}this.animateGrid(e,i,n.partEasing,n.partDuration,n.easing,n.duration,this.blindsStop)},stop:function(){this.stopGrid(),this.end()},condition:function(e,t){return!e.data("scaled")||!t.data("scaled")}}),t.define({type:"grid",config:{duration:260,easing:"easeInQuad",gridX:7,gridY:5,sort:"diagonal",sortReverse:!1,diagonalStart:"bl",method:"fade",partDuration:300,partEasing:"easeOutSine",partDirection:"left"},f:function(e,t,n,r){this.makeGrid(e,n.gridX,n.gridY),e=n.partDirection=="auto"?r:n.partDirection;var i,s;if(n.sort=="diagonal")switch(n.diagonalStart){case"tr":i=this.diagonalSort(1,1);break;case"tl":i=this.diagonalSort(-1,1);break;case"br":i=this.diagonalSort(1,-1);break;case"bl":i=this.diagonalSort(-1,-1)}else i=this[n.sort+"Sort"](n.sortReverse);switch(n.method){case"fade":s=this.getValueArray(i.length,"opacity",0);break;case"scale":s=this.getValueArray(i.length,e=="left"?"width":"height","1px")}this.animateGrid(i,s,n.partEasing,n.partDuration,n.easing,n.duration,this.gridStop)},stop:function(){this.stopGrid(),this.end()},condition:function(e,t){return!e.data("scaled")||!t.data("scaled")}})}(jQuery),function(e){function t(t){var r=t&&t.message!==undefined?t.message:undefined;t=e.extend({},e.tn3block.defaults,t||{}),r=r===undefined?t.message:r,f&&n({});var s=t.baseZ,o=e.browser.msie||t.forceIframe?e('<iframe class="blockUI" style="z-index:'+s++ +';display:none;border:none;margin:0;padding:0;position:absolute;width:100%;height:100%;top:0;left:0" src="'+t.iframeSrc+'"></iframe>'):e('<div class="blockUI" style="display:none"></div>'),l=e('<div class="blockUI '+t.cssID+'-overlay" style="z-index:'+s++ +';display:none;border:none;margin:0;padding:0;width:100%;height:100%;top:0;left:0"></div>');s=e('<div class="blockUI '+t.blockMsgClass+' blockPage" style="z-index:'+s+';display:none;position:fixed"></div>'),s.css("left","0px").css("top","0px"),(!t.applyPlatformOpacityRules||!e.browser.mozilla||!/Linux/.test(navigator.platform))&&l.css(t.overlayCSS),l.css("position","fixed"),(e.browser.msie||t.forceIframe)&&o.css("opacity",0);var c=[o,l,s],h=e("body");e.each(c,function(){this.appendTo(h)}),c=u&&(!e.boxModel||e("object,embed",null).length>0);if(a||c)t.allowBodyStretch&&e.boxModel&&e("html,body").css("height","100%"),e.each([o,l,s],function(e,n){var r=n[0].style;r.position="absolute",e<2?(r.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight)- (jQuery.boxModel?0:"+t.quirksmodeOffsetHack+') + "px"'),r.setExpression("width",'jQuery.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"')):t.centerY?(r.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2- (this.offsetHeight / 2)+ (blah = document.documentElement.scrollTop? document.documentElement.scrollTop: document.body.scrollTop)+ "px"'),r.marginTop=0):t.centerY||r.setExpression("top",'(document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"')});r&&(r.data("blockUI.parent",r.parent()),s.append(r),(r.jquery||r.nodeType)&&e(r).show()),(e.browser.msie||t.forceIframe)&&t.showOverlay&&o.show(),t.showOverlay&&l.show(),r&&s.show(),t.onBlock&&t.onBlock(),i(1,t),f=r}function n(t){t=e.extend({},e.tn3block.defaults,t||{}),i(0,t);var n=e("body").children().filter(".blockUI").add("body > .blockUI");r(n,t)}function r(e,t){e.each(function(){this.parentNode&&this.parentNode.removeChild(this)}),f.data("blockUI.parent").append(f),f=null,typeof t.onUnblock=="function"&&t.onUnblock.call(t.con)}function i(t,n){if(t||f)!n.bindEvents||t&&!n.showOverlay||(t?e(document).bind("mousedown mouseup keydown keypress",n,s):e(document).unbind("mousedown mouseup keydown keypress",s))}function s(t){var n=t.data;return e(t.target).parents("div."+n.blockMsgClass).length>0?!0:e(t.target).parents().children().filter("div.blockUI").length==0}var o=document.documentMode||0,u=e.browser.msie&&(e.browser.version<8&&!o||o<8),a=e.browser.msie&&/MSIE 6.0/.test(navigator.userAgent)&&!o;e.tn3block=function(e){t(e)},e.tn3unblock=function(e){n(e)};var f=undefined;e.tn3block.defaults={message:"<h1>Please wait...</h1>",overlayCSS:{},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:!1,baseZ:1e3,allowBodyStretch:!0,bindEvents:!0,showOverlay:!0,applyPlatformOpacityRules:!0,onBlock:null,onUnblock:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",cssID:"tn3"}}(jQuery),function(e){(e.fn.tn3.External=function(t,n){if(t){this.context=n,this.reqs=t.length;for(var r=0;r<t.length;r++)new e.fn.tn3.External[t[r].origin](t[r],this)}}).prototype={context:null,reqs:0,getImages:function(e,t){e.origin.getImages(e,t)},setAlbumData:function(e,t){this.reqs--,this.context.setAlbumData.call(this.context,e,t)},setImageData:function(e,t,n){this.context.setImageData.call(this.context,e,t,n)},getAlbumData:function(e){return this.context.data[e]}}}(jQuery);